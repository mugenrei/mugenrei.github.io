import{_ as G,r as B,b as D,o as n,c as l,d as e,t as v,e as C,f as _,u as j,g as E,s as x,w as W,h as R,i as $,v as U,j as L,F,k as T,l as J,m as Q,n as X,p as Y,q as Z,x as ee,y as g,z as te,A as oe,B as se,C as O}from"./index-9d3ac021.js";import{_ as ae}from"./banana-8d4eada8.js";const ne={class:"mod-thumbnail"},le=["src","alt"],de={key:1,class:"placeholder-thumbnail"},ie={class:"mod-basic-info"},re={class:"mod-game"},ue={class:"mod-date"},me={key:0,class:"mod-preview"},ce={key:0,class:"preview-item"},ve={key:1,class:"preview-item"},fe={key:2,class:"preview-item"},pe=["innerHTML"],ge={__name:"ModCard",props:{mod:{type:Object,required:!0}},emits:["click"],setup(a){const b=a,o=B(!1),S=y=>y?new Date(y*1e3).toLocaleDateString():"Unknown date",h=D(()=>window.innerWidth<768),w=D(()=>{if(!b.mod.modDescription)return"";const y=b.mod.modDescription.replace(/<[^>]*>/g,"");return y.length<=120?b.mod.modDescription:y.substr(0,120).split(" ").slice(0,-1).join(" ")+"..."});return(y,u)=>(n(),l("div",{class:"mod-card aero-panel",onMouseenter:u[0]||(u[0]=m=>o.value=!0),onMouseleave:u[1]||(u[1]=m=>o.value=!1),onClick:u[2]||(u[2]=m=>y.$emit("click"))},[e("div",ne,[a.mod.thumbnail?(n(),l("img",{key:0,src:a.mod.thumbnail,alt:a.mod.modName},null,8,le)):(n(),l("div",de,[e("span",null,v(a.mod.modName.charAt(0)),1)]))]),e("div",ie,[e("h3",null,v(a.mod.modName),1),e("p",re,v(a.mod.game),1),e("p",ue,v(S(a.mod.publishDate)),1)]),o.value&&!h.value?(n(),l("div",me,[a.mod.modTargetDemon?(n(),l("div",ce,[u[3]||(u[3]=e("strong",null,"Replaces:",-1)),C(" "+v(a.mod.modTargetDemon),1)])):_("",!0),a.mod.modSeries?(n(),l("div",ve,[u[4]||(u[4]=e("strong",null,"Series:",-1)),C(" "+v(a.mod.modSeries),1)])):_("",!0),a.mod.modCommissioner?(n(),l("div",fe,[u[5]||(u[5]=e("strong",null,"Thanks to:",-1)),C(" "+v(a.mod.modCommissioner),1)])):_("",!0),e("div",{class:"preview-item mod-description",innerHTML:w.value},null,8,pe),u[6]||(u[6]=e("div",{class:"mod-click-hint"},[e("span",null,"Click for details")],-1))])):_("",!0)],32))}},ye=G(ge,[["__scopeId","data-v-7f22a1bd"]]);const he={class:"mod-filters aero-panel"},be={class:"search-bar"},ke={class:"filter-grid"},_e={class:"filter-group"},Se=["value"],we={class:"filter-group date-filter"},$e={class:"filter-group date-filter"},Me={__name:"ModFilters",emits:["apply-filters","reset-filters"],setup(a,{emit:b}){const o=b,S=j(),h=E(),{uniqueSeries:w}=x(S),{filters:y}=x(h),u=D(()=>w.value),m=B({search:"",game:"",series:"",dateFrom:null,dateTo:null}),M=D({get:()=>m.value.dateFrom?m.value.dateFrom.toISOString().substring(0,10):"",set:c=>{m.value.dateFrom=c?new Date(c):null}}),f=D({get:()=>m.value.dateTo?m.value.dateTo.toISOString().substring(0,10):"",set:c=>{m.value.dateTo=c?new Date(c):null}});W(()=>y.value,c=>{m.value={...c}},{deep:!0}),R(()=>{m.value={...y.value}});function d(){Object.keys(m.value).forEach(c=>{h.setFilter(c,m.value[c])}),o("apply-filters")}function k(){h.resetFilters(),m.value={...y.value},o("reset-filters")}return(c,i)=>(n(),l("div",he,[e("div",be,[$(e("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=r=>m.value.search=r),placeholder:"Search mods...",class:"aero-input"},null,512),[[U,m.value.search]])]),e("div",ke,[e("div",_e,[i[5]||(i[5]=e("label",{for:"series-filter"},"Series:",-1)),$(e("select",{id:"series-filter","onUpdate:modelValue":i[1]||(i[1]=r=>m.value.series=r),class:"aero-select"},[i[4]||(i[4]=e("option",{value:""},"All Series",-1)),(n(!0),l(F,null,T(u.value,r=>(n(),l("option",{key:r,value:r},v(r),9,Se))),128))],512),[[L,m.value.series]])]),e("div",we,[i[6]||(i[6]=e("label",{for:"date-from"},"From:",-1)),$(e("input",{type:"date",id:"date-from","onUpdate:modelValue":i[2]||(i[2]=r=>M.value=r),class:"aero-input date-input"},null,512),[[U,M.value]])]),e("div",$e,[i[7]||(i[7]=e("label",{for:"date-to"},"To:",-1)),$(e("input",{type:"date",id:"date-to","onUpdate:modelValue":i[3]||(i[3]=r=>f.value=r),class:"aero-input date-input"},null,512),[[U,f.value]])])]),e("div",{class:"filter-actions"},[e("button",{class:"aero-button reset-button",onClick:k}," Reset Filters "),e("button",{class:"glossy-button",onClick:d}," Apply Filters ")])]))}},De=G(Me,[["__scopeId","data-v-e2a8ff84"]]);const Ce={class:"modal-container aero-glass"},Fe={class:"modal-content"},Te={class:"mod-header"},Be={class:"text-shadow"},xe={class:"mod-meta"},Ge={class:"mod-game"},Ne={class:"mod-date"},Ve={key:0,class:"mod-badge spicy"},Ue={class:"mod-content"},Le={class:"mod-main-info"},Re={class:"mod-thumbnail"},qe=["src","alt"],Ae={key:1,class:"placeholder-thumbnail"},Oe={class:"mod-details"},je={key:0,class:"detail-item"},Ee={key:1,class:"detail-item"},He={key:2,class:"detail-item"},Ie=["innerHTML"],ze={class:"mod-download"},Ke={key:0,class:"download-group"},Pe=["href"],We={key:1,class:"download-group"},Je=["href"],Qe={key:2,class:"no-downloads"},Xe={__name:"ModModal",props:{mod:{type:Object,required:!0}},emits:["close"],setup(a,{emit:b}){const o=a;R(()=>{console.log("Mod data structure:",o.mod),console.log("Has modSiteData?",!!o.mod.modSiteData),o.mod.modSiteData&&console.log("Has GameBanana data?",!!o.mod.modSiteData.GameBanana),window.addEventListener("keydown",M),document.body.style.overflow="hidden"}),J(()=>{window.removeEventListener("keydown",M),document.body.style.overflow=""});const S=b,h=()=>{S("close")},w=f=>f?new Date(f*1e3).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):"Unknown date",y=()=>{var f,d,k,c,i;return!!((d=(f=o.mod.modSiteData)==null?void 0:f.GameBanana)!=null&&d.itemUrl||(c=(k=o.mod.modSiteData)==null?void 0:k.GameBanana)!=null&&c.id&&/^\d{5,}$/.test(o.mod.modSiteData.GameBanana.id.toString())||o.mod.modDescription&&/https?:\/\/gamebanana\.com\/mods\/\d+/i.test(o.mod.modDescription)||o.mod.id&&/^\d{5,}$/.test(o.mod.id)&&((i=o.mod.modSiteData)!=null&&i.GameBanana))},u=()=>{var f,d,k,c,i;if((d=(f=o.mod.modSiteData)==null?void 0:f.GameBanana)!=null&&d.itemUrl)return o.mod.modSiteData.GameBanana.itemUrl;if((c=(k=o.mod.modSiteData)==null?void 0:k.GameBanana)!=null&&c.id&&/^\d{5,}$/.test(o.mod.modSiteData.GameBanana.id.toString()))return`https://gamebanana.com/mods/${o.mod.modSiteData.GameBanana.id}`;if(o.mod.modDescription){const r=o.mod.modDescription.match(/https?:\/\/gamebanana\.com\/mods\/\d+/i);if(r&&r.length>0)return r[0]}return o.mod.id&&/^\d{5,}$/.test(o.mod.id)&&((i=o.mod.modSiteData)!=null&&i.GameBanana)?`https://gamebanana.com/mods/${o.mod.id}`:"#"},m=D(()=>o.mod.mirrors&&Object.keys(o.mod.mirrors).length>0),M=f=>{f.key==="Escape"&&h()};return(f,d)=>(n(),l("div",{class:"modal-backdrop",onClick:Q(h,["self"])},[e("div",Ce,[e("button",{class:"close-button",onClick:h},d[0]||(d[0]=[e("span",null,"Ã—",-1)])),e("div",Fe,[e("div",Te,[e("h2",Be,v(a.mod.modName),1),e("div",xe,[e("span",Ge,v(a.mod.game),1),e("span",Ne,v(w(a.mod.publishDate)),1),a.mod.isSpicy?(n(),l("span",Ve,"Spicy")):_("",!0)])]),e("div",Ue,[e("div",Le,[e("div",Re,[a.mod.thumbnail?(n(),l("img",{key:0,src:a.mod.thumbnail,alt:a.mod.modName},null,8,qe)):(n(),l("div",Ae,[e("span",null,v(a.mod.modName.charAt(0)),1)]))]),e("div",Oe,[a.mod.modTargetDemon?(n(),l("div",je,[d[1]||(d[1]=e("strong",null,"Replaces:",-1)),C(" "+v(a.mod.modTargetDemon),1)])):_("",!0),a.mod.modSeries?(n(),l("div",Ee,[d[2]||(d[2]=e("strong",null,"Series:",-1)),C(" "+v(a.mod.modSeries),1)])):_("",!0),a.mod.modCommissioner?(n(),l("div",He,[d[3]||(d[3]=e("strong",null,"Thanks to:",-1)),C(" "+v(a.mod.modCommissioner),1)])):_("",!0),e("div",{class:"detail-item mod-description",innerHTML:a.mod.modDescription},null,8,Ie)])]),e("div",ze,[d[8]||(d[8]=e("h3",null,"Download Links",-1)),y()?(n(),l("div",Ke,[d[5]||(d[5]=e("h4",null,"GameBanana",-1)),e("a",{href:u(),target:"_blank",class:"download-button"},d[4]||(d[4]=[e("img",{src:ae,alt:"GameBanana",class:"site-icon"},null,-1),e("span",null,"View on GameBanana",-1)]),8,Pe)])):_("",!0),m.value?(n(),l("div",We,[d[6]||(d[6]=e("h4",null,"Mirror Links",-1)),(n(!0),l(F,null,T(a.mod.mirrors,(k,c)=>(n(),l("a",{key:c,href:k,target:"_blank",class:"download-button"},[e("span",null,v(c),1)],8,Je))),128))])):_("",!0),!m.value&&!y()?(n(),l("div",Qe,d[7]||(d[7]=[e("p",null,"No download links available for this mod.",-1)]))):_("",!0)])])])])]))}},Ye=G(Xe,[["__scopeId","data-v-c17324b4"]]);const Ze={class:"mods-view"},et={class:"top-controls aero-panel"},tt={class:"filter-group sort-control"},ot=["value"],st={class:"filter-group game-filter"},at=["value"],nt={class:"spicy-toggle"},lt={class:"toggle-label"},dt={class:"toggle-text"},it={key:0,class:"loading-state aero-panel"},rt={key:1,class:"error-state aero-panel"},ut={key:2,class:"no-results aero-panel"},mt={key:3,class:"mods-grid"},ct={__name:"ModsView",setup(a){const b=B(!1),o=X(),S=Y(),h=j(),{isLoading:w,error:y,activeMod:u,sortOptions:m,uniqueGames:M}=x(h),{fetchMods:f,setActiveMod:d,clearActiveMod:k,setSortOrder:c}=h,i=B(h.sortOrder),r=E(),{filteredMods:q}=x(r),{resetFilters:N,loadFromUrl:H,updateUrl:A,setFilter:vt}=r,I=D(()=>{const p=[...q.value];switch(i.value){case"newest":return p.sort((t,s)=>s.publishDate-t.publishDate);case"oldest":return p.sort((t,s)=>t.publishDate-s.publishDate);case"az":return p.sort((t,s)=>t.modName.localeCompare(s.modName));case"za":return p.sort((t,s)=>s.modName.localeCompare(t.modName));case"id_asc":return p.sort((t,s)=>Number(t.id)-Number(s.id));case"id_desc":return p.sort((t,s)=>Number(s.id)-Number(t.id));default:return p}});R(async()=>{r.filters.showSpicy=!1;try{const p=await fetch("https://ipapi.co/json/");if(p.ok){const t=await p.json();t.country_code&&t.country_code!=="BR"&&(r.filters.showSpicy=!0)}}catch(p){console.error("Could not fetch geolocation data:",p)}h.mods.length===0&&await f(),o.params.id&&d(o.params.id),H(o)}),Z(()=>{w.value||A(S)});function V(){A(S)}function z(){c(i.value);const p={...o.query,sort:i.value};S.replace({query:p})}function K(p){d(p),S.push({name:"mod-detail",params:{id:p},query:o.query})}function P(){k(),S.push({name:"mods",query:o.query})}return ee(()=>{k()}),(p,t)=>(n(),l("div",Ze,[t[12]||(t[12]=e("h2",{class:"text-shadow"},"Mods Catalog",-1)),e("div",et,[e("div",tt,[t[6]||(t[6]=e("label",{for:"sort-select"},"Sort by:",-1)),$(e("select",{id:"sort-select","onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),class:"aero-select",onChange:z},[(n(!0),l(F,null,T(g(m),s=>(n(),l("option",{key:s.value,value:s.value},v(s.label),9,ot))),128))],544),[[L,i.value]])]),e("div",st,[t[8]||(t[8]=e("label",{for:"game-filter"},"Game:",-1)),$(e("select",{id:"game-filter","onUpdate:modelValue":t[1]||(t[1]=s=>g(r).filters.game=s),class:"aero-select",onChange:V},[t[7]||(t[7]=e("option",{value:""},"All Games",-1)),(n(!0),l(F,null,T(g(M),s=>(n(),l("option",{key:s,value:s},v(s==="Shin Megami Tensei V"?"SMTV":s==="Shin Megami Tensei V: Vengeance"?"SMT5V":s),9,at))),128))],544),[[L,g(r).filters.game]])]),e("div",nt,[e("label",lt,[$(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>g(r).filters.showSpicy=s),class:"toggle-checkbox",onChange:V},null,544),[[te,g(r).filters.showSpicy]]),t[9]||(t[9]=e("span",{class:"toggle-switch"},null,-1)),e("span",dt,v(g(r).filters.showSpicy?"Include Spicy":"Family Friendly"),1)])]),e("button",{class:"filter-toggle aero-button glossy-button",onClick:t[3]||(t[3]=s=>b.value=!b.value)},v(b.value?"Hide Filters":"Show Filters"),1)]),$(se(De,{class:"mods-filters",onApplyFilters:V,onResetFilters:g(N)},null,8,["onResetFilters"]),[[oe,b.value]]),g(w)?(n(),l("div",it,t[10]||(t[10]=[e("p",null,"Loading mods catalog...",-1)]))):g(y)?(n(),l("div",rt,[e("p",null,"Error loading mods: "+v(g(y)),1),e("button",{class:"glossy-button",onClick:t[4]||(t[4]=(...s)=>g(f)&&g(f)(...s))},"Retry")])):g(q).length===0?(n(),l("div",ut,[t[11]||(t[11]=e("p",null,"No mods found matching your filters. Try adjusting your search criteria.",-1)),e("button",{class:"glossy-button",onClick:t[5]||(t[5]=(...s)=>g(N)&&g(N)(...s))},"Reset Filters")])):(n(),l("div",mt,[(n(!0),l(F,null,T(I.value,s=>(n(),O(ye,{key:s.id,mod:s,onClick:ft=>K(s.id)},null,8,["mod","onClick"]))),128))])),g(u)?(n(),O(Ye,{key:4,mod:g(u),onClose:P},null,8,["mod"])):_("",!0)]))}},yt=G(ct,[["__scopeId","data-v-f054f713"]]);export{yt as default};
